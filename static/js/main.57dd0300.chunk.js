(this["webpackJsonp@jukebox/frontend"]=this["webpackJsonp@jukebox/frontend"]||[]).push([[0],{120:function(e,t,n){e.exports=n.p+"static/media/default-artwork.6bba9800.png"},180:function(e,t){e.exports={transformUrl:function(e){var t=e.replace(/^.*\/track\//,"spotify:track:");return t.match(/spotify:track/g)?t:null}}},251:function(e,t,n){e.exports=n(395)},316:function(e,t,n){},385:function(e,t,n){},386:function(e,t,n){},388:function(e,t,n){},389:function(e,t,n){},390:function(e,t,n){},391:function(e,t,n){},392:function(e,t,n){},394:function(e,t,n){},395:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"updateToken",(function(){return H})),n.d(a,"clearToken",(function(){return q})),n.d(a,"addNewTrack",(function(){return G})),n.d(a,"addNewTracks",(function(){return J})),n.d(a,"addCurrentTrack",(function(){return W})),n.d(a,"syncSocialData",(function(){return Q})),n.d(a,"addTrackList",(function(){return X})),n.d(a,"removeFromTracklist",(function(){return Z})),n.d(a,"updateProgressTimer",(function(){return $})),n.d(a,"wsConnect",(function(){return ee})),n.d(a,"wsConnecting",(function(){return te})),n.d(a,"wsConnected",(function(){return ne})),n.d(a,"wsDisconnect",(function(){return ae})),n.d(a,"wsDisconnected",(function(){return re})),n.d(a,"mopidyConnected",(function(){return ce})),n.d(a,"mopidyDisconnected",(function(){return ie})),n.d(a,"getCurrentTrack",(function(){return oe})),n.d(a,"getTimePosition",(function(){return ue})),n.d(a,"getState",(function(){return le})),n.d(a,"getTrackList",(function(){return se})),n.d(a,"clearTrackList",(function(){return me})),n.d(a,"startPlaying",(function(){return de})),n.d(a,"stopPlaying",(function(){return fe})),n.d(a,"pausePlaying",(function(){return Ee})),n.d(a,"nextPlaying",(function(){return pe})),n.d(a,"previousPlaying",(function(){return ke})),n.d(a,"getVolume",(function(){return be})),n.d(a,"updateVolume",(function(){return ve})),n.d(a,"updatePlaybackState",(function(){return ge})),n.d(a,"setVolume",(function(){return Ce}));var r=n(0),c=n.n(r),i=n(22),o=n.n(i),u=n(17),l=n(78),s=n(224),m=n(113),d=n.n(m),f=n(225),E=n(13),p=n(14),k=n(21),b=n(20),v=function(e){Object(k.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(E.a)(this,n),(a=t.call(this,e)).state={hasError:!1},a}return Object(p.a)(n,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0})}},{key:"render",value:function(){return this.state.hasError?c.a.createElement("h1",null,"Ouch! I broke a bit."):this.props.children}}]),n}(c.a.Component),g=c.a.createContext(),C=n(237),h="playback.getCurrentTrack",y="event:trackPlaybackStarted",O="event:playbackStateChanged",T="event:trackPlaybackResumed",N="tracklist.getTracks",S="tracklist.add",D="tracklist.remove",A="tracklist.clear",_="playback.getTimePosition",j="playback.getState",P="playback.play",R="playback.stop",w="playback.pause",x="playback.next",I="playback.previous",L="playing",M="paused",U="stopped",V="mixer.setVolume",z="mixer.getVolume",B="event:volumeChanged",F="validationError",K={ADD_CURRENT_TRACK:"actionAddCurrentTrack",ADD_TRACKS:"actionAddTracks",CONNECT:"actionConnect",CONNECTING:"actionConnecting",CONNECTED:"actionConnected",DISCONNECT:"actionDisconnect",DISCONNECTED:"actionDisconnected",DROP_TYPES:["__NATIVE_URL__"],SEND:"actionSend",STORE_TOKEN:"actionStoreToken",CLEAR_STORE_TOKEN:"actionClearStoreToken",UPDATE_VOLUME:"actionUpdateVolume",UPDATE_PLAYBACK_STATE:"actionPlaybackState",UPDATE_PROGRESS_TIMER:"actionUpdateProgressTimer",MOPIDY_CONNECTED:"actionMopidyConnected",MOPIDY_DISCONNECTED:"actionMopidyDisconnected",SYNC_SOCIAL_DATA:"syncSocialData"},Y=n(180),H=function(e,t){return{type:K.STORE_TOKEN,tokenExpires:t,token:e}},q=function(){return{type:K.CLEAR_STORE_TOKEN}},G=function(e){var t=Object(Y.transformUrl)(e);return{type:K.SEND,key:S,params:{uris:[t]}}},J=function(e){return{type:K.SEND,key:S,params:{uris:e.map((function(e){return Object(Y.transformUrl)(e)}))}}},W=function(e){return{type:K.ADD_CURRENT_TRACK,track:e}},Q=function(e){return{type:K.SYNC_SOCIAL_DATA,track:e}},X=function(e){return{type:K.ADD_TRACKS,tracks:e}},Z=function(e){return{type:K.SEND,key:D,params:{criteria:{uri:[e]}}}},$=function(e,t){return t===1/0&&(t=0),{type:K.UPDATE_PROGRESS_TIMER,position:e,duration:t}},ee=function(){return{type:K.CONNECT}},te=function(){return{type:K.CONNECTING}},ne=function(){return{type:K.CONNECTED}},ae=function(){return{type:K.DISCONNECT}},re=function(){return{type:K.DISCONNECTED}},ce=function(){return{type:K.MOPIDY_CONNECTED}},ie=function(){return{type:K.MOPIDY_DISCONNECTED}},oe=function(){return{type:K.SEND,key:h}},ue=function(){return{type:K.SEND,key:_}},le=function(){return{type:K.SEND,key:j}},se=function(){return{type:K.SEND,key:N}},me=function(){return{type:K.SEND,key:A}},de=function(){return{type:K.SEND,key:P}},fe=function(){return{type:K.SEND,key:R}},Ee=function(){return{type:K.SEND,key:w}},pe=function(){return{type:K.SEND,key:x}},ke=function(){return{type:K.SEND,key:I}},be=function(){return{type:K.SEND,key:z}},ve=function(e){return{type:K.UPDATE_VOLUME,volume:e}},ge=function(e){return{type:K.UPDATE_PLAYBACK_STATE,state:e}},Ce=function(e){return{type:K.SEND,key:V,params:[Number(e)]}},he="actionVote",ye="castVote",Oe="voteCasted",Te="actionTrackSearch",Ne="searchGetTracks",Se="actionStoreSearchResults",De="actionStoreSearchQuery",Ae="actionToggleSearchSidebar",_e="actionRemoveFromSearchResults",je="curateAddTrackToMix",Pe="curateRemoveTracksFromMix",Re="searchSwapTracks",we="searchClearMix",xe=n(229),Ie=n.n(xe),Le=function(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return t+":"+(n<10?"0":"")+n},Me=function(e){return.001*e},Ue=function(e){return{type:Ae,open:e}},Ve=function(e){return{type:De,query:e}},ze=function(e,t){return{type:Te,key:Ne,params:{query:e,options:t}}},Be=function(e){return{type:_e,uris:e}},Fe="authenticationTokenInvalid",Ke={decode:function(e){return JSON.parse(e)},encodeToJson:function(e){var t=e.jwt,n=e.key,a=e.data;return JSON.stringify({jwt:t,key:n,data:a})}},Ye={info:function(e){var t=e.id,n=e.title,a=e.message;return m.store.addNotification({id:t,title:n,message:a,type:"info",insert:"top",container:"bottom-left",dismiss:{duration:3e3}})},success:function(e){var t=e.id,n=e.title,a=e.message;return m.store.addNotification({id:t,title:n,message:a,type:"success",insert:"top",container:"bottom-left",dismiss:{duration:3e3}})},warning:function(e){var t=e.id,n=e.title,a=e.message;return m.store.addNotification({id:t,title:n,message:a,type:"warning",insert:"top",container:"bottom-left",dismiss:{duration:5e3}})}},He=function(e,t){e.dispatch(ge(t))},qe=function(e,t,n){var a=Ke.decode(t),r=a.key,c=a.data,i=a.user;switch(r){case Fe:console.error("AUTHENTICATION_TOKEN_INVALID: ".concat(c.error)),e.dispatch(q());break;case h:case y:c&&function(e,t,n){t.dispatch(W(e)),t.dispatch(Q(e));var a=n.set(0,e.length);t.getState().jukebox.playbackState===L&&a.start()}(c,e,n);break;case O:case j:!function(e,t,n){switch(t){case M:case U:He(e,t),n.stop();break;case L:He(e,t),n.start()}}(e,c,n);break;case N:!function(e,t){t.dispatch(X(e))}(c,e);break;case x:case I:e.dispatch(oe());break;case V:Ye.info({title:"Volume Updated",message:"".concat(i.fullname," changed it to ").concat(c.volume)});break;case D:Ye.warning({title:"Track Removed",message:"".concat(i.fullname," removed: ").concat(c.message)});break;case S:Ye.success({title:"New Track",message:"".concat(i.fullname," added: ").concat(c.message)});break;case z:case B:e.dispatch(ve(c.volume));break;case _:n.set(c);break;case Ne:e.dispatch({type:Se,results:c});break;case Oe:c&&e.dispatch(Q(c));break;case T:n.set(c);break;case F:Ye.warning({title:"Oops",message:c.message})}},Ge={loadInitial:function(e){["getCurrentTrack","getState","getTrackList","getVolume","getTimePosition"].forEach((function(t){e.dispatch(a[t]())}))}},Je=function(){var e,t="http://".concat("jukebox-api-prod.local",":").concat("8080"),n=null;return function(r){return function(c){return function(i){var o=function(){return Ke.encodeToJson({jwt:r.getState().settings.token,key:i.key,data:i.params})},u=function(e){if(JSON.parse(e).online)return r.dispatch(ce()),Ge.loadInitial(r);r.dispatch(ie())},l=function(){n=function(e,t){return Ie()({callback:function(n,a){e.dispatch(t.updateProgressTimer(n,a))},fallbackTargetFrameRate:1,disableRequestAnimationFrame:!0})}(r,a),r.dispatch(ne())},s=function(){return r.dispatch(ae())},m=function(e){return qe(r,e,n)},d=function(e){return qe(r,e,n)},f=function(e){return qe(r,e,n)};switch(i.type){case K.CONNECT:return null!=e&&e.close(),(e=Object(C.a)(t,{transports:["websocket"]})).on("vote",f),e.on("search",d),e.on("mopidy",u),e.on("message",m),e.on("connect",l),e.on("disconnect",s),void r.dispatch(te());case K.DISCONNECT:return n&&n.reset(),void r.dispatch(re());case K.SEND:return e&&e.emit("message",o());case Te:return e&&e.emit("search",o());case he:return e&&e.emit("vote",o());default:return c(i)}}}}}(),We=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.ADD_CURRENT_TRACK:return t.track;case K.SYNC_SOCIAL_DATA:return Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics});default:return e}},Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.ADD_TRACKS:return t.tracks;case K.SYNC_SOCIAL_DATA:return e.map((function(e){return e.uri===t.track.uri?Object.assign({},e,{addedBy:t.track.addedBy,metrics:t.track.metrics}):e}));default:return e}},Xe={position:0,duration:0,remaining:0},Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.UPDATE_PROGRESS_TIMER:return{position:t.position,duration:t.duration,remaining:t.duration-t.position};default:return e}},$e={online:!1,mopidyOnline:!1,volume:0,playbackState:U},et=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.CONNECTED:return Object.assign({},e,{online:!0});case K.DISCONNECTED:return Object.assign({},e,{online:!1});case K.MOPIDY_CONNECTED:return Object.assign({},e,{mopidyOnline:!0});case K.MOPIDY_DISCONNECTED:return Object.assign({},e,{mopidyOnline:!1});case K.UPDATE_VOLUME:return Object.assign({},e,{volume:t.volume});case K.UPDATE_PLAYBACK_STATE:return Object.assign({},e,{playbackState:t.state});default:return e}},tt={tokenExpires:0,token:null},nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.STORE_TOKEN:return t.token===e.token?e:Object.assign({},e,{token:t.token,tokenExpires:t.tokenExpires});case K.CLEAR_STORE_TOKEN:return tt;default:return e}},at=n(56),rt={searchSideBarOpen:!1,query:"",limit:20,offset:0,total:0,results:[]},ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e:return Object(at.a)(Object(at.a)({},e),{},{results:e.results.filter((function(e){return!t.uris.includes(e.uri)}))});case Ae:return Object.assign({},e,{searchSideBarOpen:t.open});case De:return Object.assign({},e,{query:t.query});case Se:return Object.assign({},e,{limit:t.results.limit,offset:t.results.offset,total:t.results.total>1e4?1e4:t.results.total,results:t.results.tracks});default:return e}},it={tracks:[]},ot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case je:var n=e.tracks.find((function(e){return e.uri===t.track.uri}));return n||e.tracks.push(t.track),e;case Pe:return Object(at.a)(Object(at.a)({},e),{},{tracks:e.tracks.filter((function(e){return e.uri!==t.uri}))});case Re:var a=e.tracks;return a[t.a]=a.splice(t.b,1,a[t.a])[0],Object(at.a)(Object(at.a)({},e),{},{tracks:a});case we:return Object(at.a)(Object(at.a)({},e),{},{tracks:[]});default:return e}},ut=Object(l.combineReducers)({track:We,tracklist:Qe,timer:Ze,jukebox:et,settings:nt,search:ct,curatedList:ot}),lt=n(413),st=n(105),mt=function(){return!document["undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":"hidden"]};function dt(){var e=c.a.useState(mt()),t=Object(st.a)(e,2),n=t[0],a=t[1],r=function(){return a(mt())};return c.a.useEffect((function(){var e="undefined"!==typeof document.msHidden?"msvisibilitychange":"undefined"!==typeof document.webkitHidden?"webkitvisibilitychange":"visibilitychange";return document.addEventListener(e,r,!1),function(){document.removeEventListener(e,r)}})),n}var ft=n(92),Et=n(136),pt=n.n(Et),kt=n(424),bt=n(412),vt=n(428),gt=n(426),Ct=n(423),ht=n(72),yt=function(e){return c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",className:"jb-previous-button",disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Prev"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"step backward"})))},Ot=function(e){return c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",className:"jb-next-button",disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Next"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"step forward"})))},Tt=function(e){var t=e.disabled,n=e.onPrevious,a=e.onNext;return c.a.createElement(c.a.Fragment,null,c.a.createElement(yt,{onClick:n,disabled:t}),c.a.createElement(Ot,{onClick:a,disabled:t}))},Nt=function(e){return c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===L||e.disabled,active:e.state===L,className:"jb-play-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Play"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"play"})))},St=function(e){return c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===M||e.state===U||e.disabled,active:e.state===M,className:"jb-pause-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Pause"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"pause"})))},Dt=function(e){return c.a.createElement(Ct.a,{onClick:e.onClick,animated:"vertical",disabled:e.state===U||e.disabled,active:e.state===U,className:"jb-stop-button"},c.a.createElement(Ct.a.Content,{hidden:!0},"Stop"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"stop"})))},At=function(e){var t=Object(u.c)((function(e){return e.jukebox})),n=e.disabled,a=e.onPlay,r=e.onPause,i=e.onStop,o=e.onPrevious,l=e.onNext;return c.a.createElement("span",null,c.a.createElement(Tt,{disabled:n,onPrevious:o,onNext:l}),c.a.createElement(Nt,{onClick:a,state:t.playbackState,disabled:n}),c.a.createElement(St,{onClick:r,state:t.playbackState,disabled:n}),c.a.createElement(Dt,{onClick:i,state:t.playbackState,disabled:n}))},_t=(n(316),function(e){Object(k.a)(n,e);var t=Object(b.a)(n);function n(){return Object(E.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.connectDropTarget,n=e.isOver;return t(c.a.createElement("div",null,n?c.a.createElement("div",{className:"drag-is-over"},c.a.createElement("p",null,"Drop da track")):null,this.props.children))}}]),n}(r.Component)),jt=Object(ft.DropTarget)((function(e){return e.accepts}),{drop:function(e,t){e.onDrop&&e.onDrop(e,t)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(_t),Pt=function(e){var t=e.disabled,n=e.onDrop,a=e.children;return t?a:c.a.createElement(ft.DragDropContextProvider,{backend:pt.a},c.a.createElement(jt,{accepts:K.DROP_TYPES,onDrop:n},a))},Rt=n(422),wt=n(239),xt=n(161),It=n(236),Lt=n(421),Mt=n(414),Ut=n(158),Vt=n.n(Ut),zt=(n(385),function(e){return c.a.createElement(Lt.a,{className:"added-by-list"},e.map((function(e,t){var n=e.user?e.user.fullname:"User unknown";return c.a.createElement(Lt.a.Item,{key:t},Bt(e),c.a.createElement(Lt.a.Content,null,c.a.createElement(Lt.a.Description,null,c.a.createElement("strong",null,Vt()(e.addedAt,"dd mmm yyyy @ h:MM tt"))," - ",n)))})))}),Bt=function(e){return e&&e.user&&e.user.picture?c.a.createElement(wt.a,{avatar:!0,className:"added_by_avatar_image",src:e.user.picture}):c.a.createElement(ht.a,{name:"user"})},Ft=function(e){var t=e.users,n=void 0===t?[]:t,a=Bt(n[0]);return n.length?c.a.createElement(Mt.a,{wide:!0,content:zt(n),trigger:a}):a},Kt=(n(386),function(e){return Math.round(e/10-5)}),Yt=function(e){return c.a.createElement(Lt.a,null,e.votes.map((function(e,t){var n=e.user?e.user.fullname:"User unknown",a=c.a.createElement(xt.a,{circular:!0,size:"mini"},Kt(e.vote));return c.a.createElement(Lt.a.Item,{key:t},Ht(e),c.a.createElement(Lt.a.Content,null,c.a.createElement(Lt.a.Description,null,c.a.createElement("strong",null,Vt()(e.at,"dd mmm yyyy @ h:MM tt"))," - ",n," ",a)))})))},Ht=function(e){return e&&e.user&&e.user.picture?c.a.createElement(wt.a,{avatar:!0,className:"voted_by_avatar_image",src:e.user.picture}):null},qt=function(e){var t=!0,n="grey",a="thumbs up",r=Kt(e.total);return r<0&&(a="thumbs down"),r>4&&(n="green",t=!1),r<-4&&(n="red",t=!1),c.a.createElement(xt.a,{className:"track-label vote-track-label",size:e.size||"tiny",color:n,basic:t,icon:a,content:r,ribbon:e.ribbon?"right":null})},Gt=function(e){var t=e.votes?e.votes.length:0;return e.show?t<1?qt(e):c.a.createElement(Mt.a,{wide:"very",content:Yt(e),trigger:qt(e)}):null},Jt=n(238),Wt=function(){var e=Object(u.c)((function(e){return e.timer})),t=Object(u.c)((function(e){return e.track})),n=function(e){if(0===e.duration)return 0;var t=Me(e.position),n=Me(e.duration),a=Math.round(t/n*100);return isNaN(a)?0:a}(e);return c.a.createElement("div",{className:"progress-container"},c.a.createElement("span",{className:"remaining-text"},Le(e.remaining)),c.a.createElement("span",{className:"track-length"},Le(t.length)),c.a.createElement(Jt.a,{percent:n}))},Qt=n(120),Xt=n.n(Qt),Zt=n(183),$t=(n(387),n(388),{0:{style:{color:"red"},label:c.a.createElement(ht.a,{name:"thumbs down",color:"red"})},50:c.a.createElement(ht.a,{name:"handshake"}),100:{style:{color:"green"},label:c.a.createElement(ht.a,{name:"thumbs up",color:"green"})}}),en=function(e){var t=e.split(":").pop();return"https://open.spotify.com/track/".concat(t)},tn=function(e){var t=" (".concat(e.album.year,")");return c.a.createElement(Rt.a.Description,null,e.album.name,t)},nn=function(e){var t=e.map((function(e){return e.vote}));return t.length<1?0:Object(Zt.mean)(Object(Zt.flatten)(t))},an=function(e){return e>50?"#21ba45":e<50?"red":"gray"},rn=function(e){return e.metrics?c.a.createElement(Gt,{total:e.metrics.votesAverage,show:e.metrics.votes>0,ribbon:!0}):null},cn=function(e){return c.a.createElement(xt.a,{size:"mini"},"Added",c.a.createElement(xt.a.Detail,null,e.count))},on=function(e){return e.metrics?c.a.createElement(xt.a,{size:"mini"},"Played",c.a.createElement(xt.a.Detail,null,e.metrics.plays)):null},un=function(e){return e.metrics?c.a.createElement(xt.a,{size:"mini"},"Activity",c.a.createElement(xt.a.Detail,null,e.metrics.votes)):null},ln=function(e){var t=e.track,n=e.onVote,a=e.userID;if(!t)return c.a.createElement(Rt.a,null,c.a.createElement(wt.a,{src:Xt.a}),c.a.createElement(Rt.a.Content,null,c.a.createElement(Rt.a.Header,null,"Nothing playing"),c.a.createElement(Rt.a.Description,null,"Drag some music here or press play.")));var r,i=t.addedBy,o=void 0===i?[]:i,u=o[0]&&o[0].votes||[],l=u.find((function(e){return e.user._id===a})),s=l?l.vote:null;return c.a.createElement(Rt.a,null,c.a.createElement(wt.a,{src:t.image||Xt.a,label:c.a.createElement(rn,{metrics:t.metrics})}),c.a.createElement(Rt.a.Content,null,c.a.createElement(Wt,null),c.a.createElement(Rt.a.Header,null,t.name),c.a.createElement(Rt.a.Meta,null,t.artist.name),c.a.createElement(tn,{album:t.album})),c.a.createElement(Rt.a.Content,{extra:!0},c.a.createElement("div",{className:"track-rating-container"},c.a.createElement(It.a,{disabled:!a,dots:!0,value:s,included:!1,marks:$t,step:10,onChange:(r=t.uri,function(e){return n(r,e/10)}),handleStyle:{borderColor:an(s),backgroundColor:an(s)}}))),c.a.createElement(Rt.a.Content,{extra:!0},c.a.createElement(cn,{count:o.length}),c.a.createElement(on,{metrics:t.metrics}),c.a.createElement(un,{metrics:t.metrics}),c.a.createElement(Gt,{size:"mini",show:u.length>0,total:nn(u),votes:u})),c.a.createElement(Rt.a.Content,{extra:!0},c.a.createElement(Ft,{users:t.addedBy}),c.a.createElement("a",{className:"track-uri",href:en(t.uri),target:"_blank",rel:"noopener noreferrer"},t.uri)))},sn=function(){var e=Object(r.useContext)(g).googleUser,t=Object(u.c)((function(e){return e.track})),n=Object(u.b)();return c.a.createElement(ln,{userID:e&&e.googleId,track:t,onVote:function(e,t){return n(function(e,t){return{type:he,key:ye,params:{uri:e,vote:t}}}(e,t))}})},mn=(n(389),function(){var e=Object(r.useContext)(g),t=e.googleUser,n=e.grantOfflineAccess,a=e.signOut,i=c.a.createElement(Ct.a,{icon:"power off",floated:"right",onClick:function(){return n()},className:"jb-settings-toggle",title:"Login using Google"});return t&&t.profileObj&&(i=c.a.createElement(wt.a,{rounded:!0,size:"mini",floated:"right",title:t.profileObj.name,src:t.profileObj.imageUrl,onClick:function(){return a()}})),c.a.createElement(c.a.Fragment,null,i)}),dn=n(11),fn=n.n(dn),En=n(417),pn=n(419),kn=n(418),bn=function(e){var t=c.a.useState(!1),n=Object(st.a)(t,2),a=n[0],r=n[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(En.a.Action,{className:"remove-track",onClick:function(){return r(!0)}},"Remove"),c.a.createElement(kn.a,{content:"Are you sure you want to remove: ".concat(e.name),cancelButton:"No thanks",confirmButton:"Do it!",open:a,onCancel:function(){return r(!1)},onConfirm:function(t){e.onClick(t),r(!1)}}))},vn=(n(390),function(e){return c.a.createElement(En.a.Avatar,{className:e.isCurrent?"current-image":null,src:e.src})}),gn=function(e){var t=e.image?e.image:Xt.a;return c.a.createElement(vn,{src:t,isCurrent:e.isCurrent})},Cn=function(e){return c.a.createElement(En.a.Author,null,e.name)},hn=function(e){return c.a.createElement(En.a.Text,null,c.a.createElement(pn.a,{as:"a",className:"track-search-link",onClick:e.onClick},e.artistName)," ",c.a.createElement("small",null,"(",Le(e.trackLength),")"))},yn=function(e){if(!e.metrics)return null;var t=e.metrics.votes>0;return t?c.a.createElement(En.a.Action,{as:"span"},c.a.createElement(Gt,{total:e.metrics.votesAverage,show:t})):null},On=function(e){if(e.isCurrent||e.disabled)return null;var t,n;return c.a.createElement(bn,{uri:e.uri,name:e.name,onClick:(t=e.uri,n=e.onClick,function(){return n(t)})})},Tn=function(e){var t=!0,n="grey";return e.metrics?(e.metrics.plays>0&&(t=!1,n=null),c.a.createElement(En.a.Action,{as:"span"},c.a.createElement(xt.a,{className:"track-label",size:"tiny",color:n,basic:t},"Played ",c.a.createElement(xt.a.Detail,null,e.metrics.plays)))):null},Nn=function(e){var t=!1;return e.tracks.map((function(n,a){var r,i,o=n.addedBy,u=(r=e.current,i=n.uri,r&&r.uri===i);return u&&(t=t||!0),c.a.createElement(En.a,{className:fn()({"current-track":u}),key:"".concat(a).concat(n.uri)},c.a.createElement(gn,{image:n.image,isCurrent:u}),c.a.createElement(En.a.Content,{className:fn()({"track-info":!t})},c.a.createElement(Cn,{name:n.name}),c.a.createElement(hn,{artistName:n.artist.name,trackLength:n.length,onClick:e.onArtistSearch(n.artist.name)}),c.a.createElement(En.a.Actions,null,c.a.createElement(yn,{metrics:n.metrics}),c.a.createElement(Tn,{metrics:n.metrics}),c.a.createElement(En.a.Action,null,c.a.createElement(Ft,{users:o})),c.a.createElement(On,{uri:n.uri,name:n.name,disabled:e.disabled,isCurrent:u,onClick:e.onRemove}))))}))},Sn=function(e){return e.tracks?c.a.createElement(En.a.Group,{size:"small"},c.a.createElement(Nn,{disabled:e.disabled,tracks:e.tracks,current:e.currentTrack,onRemove:e.onRemoveTrack,onArtistSearch:e.onArtistSearch})):null},Dn=function(e){return c.a.createElement(Ct.a,{animated:"vertical",floated:"right",onClick:e.onClick,disabled:e.disabled},c.a.createElement(Ct.a.Content,{hidden:!0},"Search"),c.a.createElement(Ct.a.Content,{visible:!0},c.a.createElement(ht.a,{name:"search"})))},An=function(e,t){if((e+=5)<=100)return function(){t(e)}},_n=function(e,t){if((e-=5)>=0)return function(){t(e)}},jn=function(e){return c.a.createElement(Ct.a,{className:"jb-volume-down",onClick:_n(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(ht.a,{name:"volume down"}))},Pn=function(e){return c.a.createElement(Ct.a,{className:"jb-volume-up",onClick:An(e.volume,e.onChange),disabled:e.disabled},c.a.createElement(ht.a,{name:"volume up"}))},Rn=function(e){var t=e.disabled,n=e.onVolumeChange,a=Object(u.c)((function(e){return e.jukebox}));return c.a.createElement(Ct.a.Group,{floated:"right"},c.a.createElement(jn,{volume:a.volume,onChange:n,disabled:t}),c.a.createElement(Ct.a.Or,{text:a.volume}),c.a.createElement(Pn,{volume:a.volume,onChange:n,disabled:t}))},wn=function(e){var t=c.a.useState(!1),n=Object(st.a)(t,2),a=n[0],r=n[1];if(e.disabled)return null;return c.a.createElement(c.a.Fragment,null,c.a.createElement(xt.a,{horizontal:!0,size:"mini",as:"a",color:"red",onClick:function(){return r(!0)},className:"jb-clear-button"},"CLEAR"),c.a.createElement(kn.a,{content:"Are you sure you want to nuke the playlist?",cancelButton:"No thanks",confirmButton:"Do it!",open:a,onCancel:function(){return r(!1)},onConfirm:function(t){e.onClear(t),r(!1)}}))},xn=n(427),In=n(415),Ln=n(416),Mn=function(e){return e.metrics?c.a.createElement(Gt,{size:"mini",total:e.metrics.votesAverage,show:e.metrics.votes>0}):null},Un=function(e){return c.a.createElement("div",{className:fn()(e.className,"search-list-item",{disabled:e.track.explicit})},c.a.createElement(wt.a,{alt:e.track.name,floated:"left",src:e.track.image,size:"tiny",title:"Click to add - ".concat(e.track.name," - ").concat(e.track.artist.name),className:"search-list-item__image",disabled:e.track.explicit,onClick:e.track.explicit?void 0:e.onClick}),c.a.createElement(Lt.a.Content,null,c.a.createElement("div",{className:"search-list-item__header"},e.track.name," - ",e.track.artist.name),c.a.createElement("div",{className:"search-list-item__content"},e.track.album.name),c.a.createElement(Mn,{metrics:e.track.metrics}),e.onAdd?c.a.createElement("span",{onClick:e.onAdd,className:"search-list-item__add"},"Add to mix"):null))},Vn=function(e){var t=e.i;return c.a.createElement("div",{draggable:!0,className:fn()("draggable","search-list-item-draggable"),onDragStart:function(e){return function(e,t){e.dataTransfer&&e.dataTransfer.setData("text/plain",t)}(e,String(t))},onDrop:function(n){return function(t,n){var a=t.dataTransfer&&t.dataTransfer.getData("text/plain");a&&e.action(parseInt(n,10),parseInt(a,10))}(n,String(t))},title:"You can drag this to sort."},c.a.createElement(Un,{key:e.track.uri,track:e.track}),c.a.createElement("span",{onClick:e.onRemove,className:"search-list-item__remove"},"Remove"))},zn=(n(391),function(e){return c.a.createElement(c.a.Fragment,null,e.tracks.map((function(t){return c.a.createElement(Un,{key:t.uri,track:t,onClick:function(){return e.onClick(t.uri)},onAdd:function(){return e.onAdd(t)}})})))}),Bn=function(e){return c.a.createElement(c.a.Fragment,null,e.tracks.map((function(t,n){return c.a.createElement(Vn,{i:n,key:n,track:t,onRemove:function(){return e.onRemove(t.uri)},action:e.onSwap})})))},Fn=function(e){if(0===e.tracks.length)return null;var t=e.tracks.map((function(e){return e.uri}));return c.a.createElement(c.a.Fragment,null,c.a.createElement(bt.a,{horizontal:!0},c.a.createElement(gt.a,{as:"h4",inverted:!0},"Your Mix")),c.a.createElement(Lt.a,{divided:!0,inverted:!0,size:"tiny"},c.a.createElement(Bn,{tracks:e.tracks,onRemove:e.onRemoveFromMix,onSwap:e.onSwapTracks})),c.a.createElement(Ct.a,{fluid:!0,onClick:function(){return e.onAddTracks(t)},className:"search-list-item__add_to_mix"},"Add mix to playlist"),c.a.createElement(bt.a,{horizontal:!0}))},Kn=function(e){var t=e.visible,n=e.onClose,a=e.results,r=e.curatedList,i=e.onSubmit,o=e.query,u=e.onSwapTracks,l=e.onRemoveFromMix,s=e.onQueryChange,m=e.onAddTrack,d=e.onAddTracks,f=e.onAddTrackToMix,E=e.totalPages,p=e.onPageChange,k=c.a.useRef(null);return c.a.createElement(xn.a.Pushable,null,c.a.createElement(xn.a,{animation:"overlay",icon:"labeled",inverted:"true",vertical:"true",visible:t,width:"very wide",direction:"right",className:"sidebar-search",onShow:function(){return k.current&&k.current.focus()}},c.a.createElement(Fn,{tracks:r,onSwapTracks:u,onAddTracks:d,onRemoveFromMix:l}),c.a.createElement(In.a,{inverted:!0,onSubmit:i},c.a.createElement(In.a.Field,null,c.a.createElement("label",null,"SEARCH"),c.a.createElement("input",{ref:k,"aria-label":"search-input",placeholder:"track, artist or album",onChange:s,value:o})),c.a.createElement(Ct.a,{type:"submit",fluid:!0},"Find")),c.a.createElement(bt.a,{horizontal:!0},c.a.createElement(gt.a,{as:"h4",inverted:!0},"Results")),E>0&&c.a.createElement(Ln.a,{className:"search-list-pagination",defaultActivePage:1,firstItem:null,lastItem:null,pointing:!0,secondary:!0,totalPages:E,onPageChange:p}),c.a.createElement(Lt.a,{divided:!0,relaxed:!0,inverted:!0,size:"tiny"},c.a.createElement(zn,{tracks:a,onClick:m,onAdd:f}))),c.a.createElement(xn.a.Pusher,{dimmed:t,onClick:t?n:null},e.children))},Yn=function(e){return e.search},Hn=function(e){return e.curatedList},qn=function(e){var t=Object(u.c)(Yn),n=Object(u.c)(Hn),a=Object(u.b)(),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{activePage:1},n={offset:(e.activePage-1)*t.limit,limit:t.limit};a(ze(t.query,n))};return c.a.createElement(Kn,{visible:t.searchSideBarOpen,onClose:function(){return a(Ue(!1))},onSubmit:function(){return r()},onSwapTracks:function(e,t){a(function(e,t){return{type:Re,a:e,b:t}}(e,t))},onAddTrack:function(e){a(Be([e])),a(G(e))},onAddTracks:function(e){a(J(e)),a({type:we})},onAddTrackToMix:function(e){n.tracks.length<5&&(a(Be([e.uri])),a(function(e){return{type:je,track:e}}(e)))},onRemoveFromMix:function(e){a(function(e){return{type:Pe,uri:e}}(e)),r()},onQueryChange:function(e){return a(Ve(e.target.value))},onPageChange:function(e,t){return r(t)},results:t.results,curatedList:n.tracks,totalPages:Math.round(t.total/t.limit),query:t.query},e.children)},Gn=(n(392),function(e){var t=e.online,n=e.disabled,a=e.onPlay,r=e.onStop,i=e.onPause,o=e.onNext,u=e.onPrevious,l=e.onVolumeChange,s=e.onDrop,m=e.onTracklistClear,d=e.onSearchClick,f=e.tracklist,E=e.currentTrack,p=e.onRemoveTrack,k=e.onArtistSearch;return c.a.createElement(kt.a.Dimmable,{blurring:!0,dimmed:!t},c.a.createElement(Pt,{disabled:n,onDrop:s},c.a.createElement(qn,null,c.a.createElement(lt.a,{className:"header-wrapper",fluid:!0},c.a.createElement(mn,null),c.a.createElement(Rn,{disabled:n,onVolumeChange:l}),c.a.createElement(Dn,{onClick:d,disabled:n}),c.a.createElement(At,{disabled:n,onPlay:a,onStop:r,onPause:i,onNext:o,onPrevious:u})),c.a.createElement(bt.a,null),c.a.createElement(lt.a,{className:"body-wrapper",fluid:!0},c.a.createElement(vt.a,{stackable:!0,columns:2,className:"dashboard-grid"},c.a.createElement(vt.a.Column,{width:4},c.a.createElement(gt.a,{size:"small"},"Current Track"),c.a.createElement(sn,null)),c.a.createElement(vt.a.Column,{width:8},c.a.createElement(gt.a,{size:"small"},"Playlist ",c.a.createElement(wn,{disabled:n,onClear:m})),c.a.createElement(Sn,{disabled:n,tracks:f,currentTrack:E,onRemoveTrack:p,onArtistSearch:k})))))))}),Jn=Object(ft.DragDropContext)(pt.a)((function(){var e=dt(),t=Object(u.c)((function(e){return e.settings})),n=Object(u.c)((function(e){return e.jukebox})),a=Object(u.c)((function(e){return e.tracklist})),i=Object(u.c)((function(e){return e.track})),o=Object(u.b)(),l=Object(r.useContext)(g),s=l.isSignedIn,m=l.googleUser,d=l.auth2,f=!(s&&n.mopidyOnline);if(Object(r.useEffect)((function(){return o(ee()),function(){return o(ae())}}),[o]),s&&e){m.expiresAt>t.tokenExpires&&o(H(m.tokenId,m.expiresAt)),t.tokenExpires>0&&t.tokenExpires-3e5-Date.now()<=0&&d.currentUser.get().reloadAuthResponse().then((function(e){console.info("Token Refreshed (expires): ",e.expires_at),o(H(e.id_token,e.expires_at))}),(function(e){return console.warn("Token un-refreshable: ",e.message)}))}s||o(q());var E=Object(r.useCallback)((function(){return o(de())}),[o]),p=Object(r.useCallback)((function(){return o(fe())}),[o]),k=Object(r.useCallback)((function(){return o(Ee())}),[o]),b=Object(r.useCallback)((function(){return o(pe())}),[o]),v=Object(r.useCallback)((function(){return o(ke())}),[o]),C=Object(r.useCallback)((function(e){return o(Ce(e))}),[o]),h=Object(r.useCallback)((function(e,t){var n=t.getItem().urls[0].split("https://").map((function(e){return"https://"+e})).slice(1);t&&(n.length<=5?n.forEach((function(e){o(G(e))})):Ye.warning({title:"Oops",message:"You can only add a maximum of 5 tracks at a time!"}))}),[o]),y=Object(r.useCallback)((function(){return o(me())}),[o]),O=Object(r.useCallback)((function(){return o(Ue(!0))}),[o]),T=Object(r.useCallback)((function(e){return o(Z(e))}),[o]),N=Object(r.useCallback)((function(e){return function(t){var n={offset:0};o(ze(e,n)),o(Ve(e)),o(Ue(!0))}}),[o]);return c.a.createElement(Gn,{online:n.online,disabled:f,onPlay:E,onStop:p,onPause:k,onNext:b,onPrevious:v,onVolumeChange:C,onDrop:h,onTracklistClear:y,onSearchClick:O,tracklist:a,currentTrack:i,onRemoveTrack:T,onArtistSearch:N})})),Wn=(n(393),Object(l.createStore)(ut,Object(s.composeWithDevTools)(Object(l.applyMiddleware)(Je)))),Qn=function(){var e=Object(f.useGoogleLogin)({clientId:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",hostedDomain:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_CLIENT_ID:"383651533710-l72a24lkiulclgqes5mkgt5ujb2rspiu.apps.googleusercontent.com",REACT_APP_WS_PORT:"8080",REACT_APP_WS_URL:"jukebox-api-prod.local"}).GOOGLE_AUTH_DOMAIN});return c.a.createElement(u.a,{store:Wn},c.a.createElement(d.a,null),c.a.createElement(lt.a,{fluid:!0},c.a.createElement(g.Provider,{value:e},c.a.createElement(v,null,c.a.createElement(Jn,null)))))};n(394);o.a.render(c.a.createElement(Qn,null),document.getElementById("root"))}},[[251,1,2]]]);
//# sourceMappingURL=main.57dd0300.chunk.js.map